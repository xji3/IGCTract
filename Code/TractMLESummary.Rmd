---
title: "TractMLESummary"
output: pdf_document
---

This script is used to summarize IGC tract length model with 14 Yeast data sets.

```{r}
rm(list=ls())  # clean up workspace
setwd("/Users/xji3/GitFolders/YeastIGCTract/Code/")

finished.pairs <- readLines('./Finished_Pairs.txt')

JS.HKY.nonclock.summary <- NULL
PSJS.HKY.nonclock.summary <- NULL
for(pair in finished.pairs){
  summary.file.name <- paste("JS_HKY", pair, "One_rate_nonclock_summary.txt", sep = "_")
  summary_file <- paste("./summary/", summary.file.name, sep = "")
  all <- readLines(summary_file, n = -1)
  row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
  summary_mat <- as.matrix(read.table(summary_file, 
                                      row.names = row.names,
                                      col.names = pair))
  JS.HKY.nonclock.summary <- cbind(JS.HKY.nonclock.summary, summary_mat)
  
  summary.file.name <- paste("PSJS_HKY", pair, "One_rate_nonclock_summary.txt", sep = "_")
  summary_file <- paste("./summary/", summary.file.name, sep = "")
  all <- readLines(summary_file, n = -1)
  row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
  summary_mat <- as.matrix(read.table(summary_file, 
                                      row.names = row.names,
                                      col.names = pair))
  PSJS.HKY.nonclock.summary <- cbind(PSJS.HKY.nonclock.summary, summary_mat)
  
}


```

Now show the estimated tract length and IGC initiation rates.

```{r}
# Estimated Tract length (unit: nucleotide)
PSJS.HKY.nonclock.summary["tract_length", ]

# initial guess tract length
JS.HKY.nonclock.summary["Tau",] / exp(-0.6)

# Initiation rate 
PSJS.HKY.nonclock.summary["init_rate", ]

# Now compare the product of init_rate and tract length with IGC+HKY model estimated Tau value
illustract.mat <- rbind(PSJS.HKY.nonclock.summary['init_rate', ] * PSJS.HKY.nonclock.summary["tract_length", ], JS.HKY.nonclock.summary['Tau',])
row.names(illustract.mat) <- c('product', 'estimated Tau')
illustract.mat

```

Now plot 2 dimensional lnL for 2 pairs

```{r}
library("lattice")
plot.pairs <- c("YLR333C_YGR027C", "YLR406C_YDL075W")
# show estimated tract length
PSJS.HKY.nonclock.summary["tract_length", plot.pairs]
for( pair in plot.pairs){
  plot.file.name <- paste("./plot/", pair, "_PSJS_lnL_TractLength.txt", sep = "")
  plot.data <- read.table(plot.file.name)
  plot(plot.data[, 2], plot.data[, 3], xlab = "init rate", ylab = "lnL", main = pair)
  assign(pair, plot.data)
  
  
  
  plot.file.name <- paste("./plot/", pair, "_PSJS_lnL_TractLength_zoomed.txt", sep = "")
  plot.data <- read.table(plot.file.name)
  plot(plot.data[, 2], plot.data[, 3], xlab = "init rate", ylab = "lnL", main = paste(pair, "_zoomed", sep = ""))
  assign(paste(pair, ".zoomed", sep = ""), plot.data)
}


x <- 1:12
y <- 5:19 * 0.1
z <- matrix(YLR333C_YGR027C[1 : (length(x) * length(y)), 3], nrow = length(x), ncol = length(y), byrow = TRUE)
wireframe(z, row.values = x, col.values = y, xlab = "tract length", ylab = "init rate", zlab = "lnL", main = "YLR333C_YGR027C")

z <- matrix(YLR406C_YDL075W[1 : (length(x) * length(y)), 3], nrow = length(x), ncol = length(y), byrow = TRUE)
wireframe(z, row.values = x, col.values = y, xlab = "tract length", ylab = "init rate", zlab = "lnL", main = "YLR406C_YDL075W")

#image(x, y, z)
```

```{r}
# Now export data
save.image(file = "./TractSummary.RData")
```

