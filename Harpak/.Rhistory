num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.missing.species.list <- c(num.missing.species.list, num.spe)
}
row.num
info
seq.file
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
info
rm(list=ls())  # clean up workspace
setwd("/Users/xji3/GitFolders/YeastIGCTract/Harpak/")
alignment.files <- list.files("./intronAlignmentSeparated/")
alignment.files <- alignment.files[alignment.files != "group_1056.intron8.pos.seq.formatted"]
num.missing.genes.list <- NULL
filtered.files <- NULL
for(seq.file in alignment.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
num.missing.genes <- sum(is.na(info[, 1]))
num.missing.genes.list <- c(num.missing.genes.list, num.missing.genes)
if(num.missing.genes == 0){
filtered.files <- c(filtered.files, seq.file)
}
}
table(num.missing.genes.list)
num.missing.species.list  <- NULL
for(num.spe in 1:4){
assign(paste("missing", num.spe, "species", sep = "."), NULL)
}
for(seq.file in alignment.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap < 1e-6){
info[row.num, 1] <- NA
}
}
num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.missing.species.list <- c(num.missing.species.list, num.spe)
}
seq.file
info
alignment.files <- alignment.files[alignment.files != "group_1056.intron8.pos.seq.formatted"
& alignment.files != "group_158.intron5.pos.seq.formatted"]
num.missing.species.list  <- NULL
for(num.spe in 1:4){
assign(paste("missing", num.spe, "species", sep = "."), NULL)
}
for(seq.file in alignment.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap < 1e-6){
info[row.num, 1] <- NA
}
}
num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.missing.species.list <- c(num.missing.species.list, num.spe)
}
info
seq.file
dim(info)
rm(list=ls())  # clean up workspace
setwd("/Users/xji3/GitFolders/YeastIGCTract/Harpak/")
alignment.files <- list.files("./intronAlignmentSeparated/")
filtered.alignment.files <- NULL
num.missing.genes.list <- NULL
filtered.files <- NULL
for(seq.file in alignment.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
num.missing.genes <- sum(is.na(info[, 1]))
num.missing.genes.list <- c(num.missing.genes.list, num.missing.genes)
if(num.missing.genes == 0){
filtered.files <- c(filtered.files, seq.file)
}
if(dim(info)[2] > 1){
filtered.alignment.files <- c(filtered.alignment.files, seq.file)
}
}
table(num.missing.genes.list)
num.missing.species.list  <- NULL
for(num.spe in 1:4){
assign(paste("missing", num.spe, "species", sep = "."), NULL)
}
for(seq.file in filtered.alignment.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap < 1e-6){
info[row.num, 1] <- NA
}
}
num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.missing.species.list <- c(num.missing.species.list, num.spe)
}
table(num.missing.species.list)
num.missing.species.list  <- NULL
for(num.spe in 1:4){
assign(paste("missing", num.spe, "species", sep = "."), NULL)
}
for(seq.file in filtered.alignment.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap < 1e-6){
info[row.num, 1] <- NA
}
}
num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.missing.species.list <- c(num.missing.species.list, num.spe)
specific.list <- get(paste("missing", num.spe, "species", sep = "."))
specific.list <- c(specific.list, seq.file)
}
num.missing.species.list  <- NULL
for(num.spe in 1:5){
assign(paste("missing", num.spe, "species", sep = "."), NULL)
}
for(seq.file in filtered.alignment.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap < 1e-6){
info[row.num, 1] <- NA
}
}
num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.missing.species.list <- c(num.missing.species.list, num.spe)
specific.list <- get(paste("missing", num.spe, "species", sep = "."))
specific.list <- c(specific.list, seq.file)
}
missing.1.species
num.missing.species.list
table(num.missing.species.list)
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap < 1e-6){
info[row.num, 1] <- NA
}
}
num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.spe
info[, 1]
info
seq.file
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
info[,1]
info
row.num = 1
seq <- strsplit(info[row.num, 2], "")[[1]]
seq
additional.failure <- NULL
for(seq.file in filtered.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap > 1 - 1e-6){
if( ! seq.file %in% additional.failure)
additional.failure <- c(additional.failure, seq.file)
}
}
}
# See how many have missing info
length(additional.failure)
additional.failure
additional.failure <- NULL
additional.filtered <- NULL
for(seq.file in filtered.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap > 1 - 1e-6){
if( ! seq.file %in% additional.failure)
additional.failure <- c(additional.failure, seq.file)
}else{
additional.filtered <- c(additional.filtered, seq.file)
}
}
}
# See how many have missing info
length(additional.failure)
additional.filtered
additional.failure <- NULL
for(seq.file in filtered.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap > 1 - 1e-6){
if( ! seq.file %in% additional.failure)
additional.failure <- c(additional.failure, seq.file)
}
}
}
additional.filtered <- filtered.files[! filtered.files %in% additional.failure]
# See how many have missing info
length(additional.failure)
length(additional.filtered)
additional.filtered
num.missing.species.list  <- NULL
for(num.spe in 1:5){
assign(paste("missing", num.spe, "species", sep = "."), NULL)
}
for(seq.file in filtered.alignment.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap > 1 - 1e-6){
info[row.num, 1] <- NA
}
}
num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.missing.species.list <- c(num.missing.species.list, num.spe)
specific.list <- get(paste("missing", num.spe, "species", sep = "."))
specific.list <- c(specific.list, seq.file)
}
num.missing.species.list  <- NULL
for(num.spe in 0:5){
assign(paste("missing", num.spe, "species", sep = "."), NULL)
}
for(seq.file in filtered.alignment.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap > 1 - 1e-6){
info[row.num, 1] <- NA
}
}
num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.missing.species.list <- c(num.missing.species.list, num.spe)
specific.list <- get(paste("missing", num.spe, "species", sep = "."))
specific.list <- c(specific.list, seq.file)
}
table(num.missing.species.list)
missing.1.species
num.missing.species.list  <- NULL
for(num.spe in 0:5){
assign(paste("missing", num.spe, "species", sep = "."), NULL)
}
for(seq.file in filtered.alignment.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap > 1 - 1e-6){
info[row.num, 1] <- NA
}
}
num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.missing.species.list <- c(num.missing.species.list, num.spe)
specific.list <- get(paste("missing", num.spe, "species", sep = "."))
specific.list <- c(specific.list, seq.file)
}
table(num.missing.species.list)
# In addition, show files that have only one ingroup species that misses either one or both copies
missing.1.species
missing.0.species
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap > 1 - 1e-6){
info[row.num, 1] <- NA
}
}
num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.spe
num.missing.species.list <- c(num.missing.species.list, num.spe)
specific.list <- get(paste("missing", num.spe, "species", sep = "."))
specific.list
num.missing.species.list  <- NULL
for(num.spe in 0:5){
assign(paste("missing", num.spe, "species", sep = "."), NULL)
}
for(seq.file in filtered.alignment.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap > 1 - 1e-6){
info[row.num, 1] <- NA
}
}
num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.missing.species.list <- c(num.missing.species.list, num.spe)
get(paste("missing", num.spe, "species", sep = ".")) <- c(get(paste("missing", num.spe, "species", sep = ".")), seq.file)
}
get(paste("missing", num.spe, "species", sep = "."))
c(get(paste("missing", num.spe, "species", sep = ".")), seq.file)
num.missing.species.list  <- NULL
for(num.spe in 0:5){
assign(paste("missing", num.spe, "species", sep = "."), NULL)
}
for(seq.file in filtered.alignment.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap > 1 - 1e-6){
info[row.num, 1] <- NA
}
}
num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.missing.species.list <- c(num.missing.species.list, num.spe)
assign(get(paste("missing", num.spe, "species", sep = ".")), c(get(paste("missing", num.spe, "species", sep = ".")), seq.file))
}
c(get(paste("missing", num.spe, "species", sep = ".")), seq.file)
get(paste("missing", num.spe, "species", sep = "."))
num.missing.species.list  <- NULL
for(num.spe in 0:5){
assign(paste("missing", num.spe, "species", sep = "."), NULL)
}
for(seq.file in filtered.alignment.files){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
percent.gap <- length(grep("-", seq))/length(seq)
if (percent.gap > 1 - 1e-6){
info[row.num, 1] <- NA
}
}
num.spe <- 0
for(row.iter in 1:5){
if(any(is.na(info[c(row.iter*2-1, row.iter*2), 1]))){
num.spe <- num.spe + 1
}
}
num.missing.species.list <- c(num.missing.species.list, num.spe)
assign(paste("missing", num.spe, "species", sep = "."), c(get(paste("missing", num.spe, "species", sep = ".")), seq.file))
}
table(num.missing.species.list)
# In addition, show files that have only one ingroup species that misses either one or both copies
missing.1.species
missing.0.species
# 20 files that have no missing genes
missing.0.length <- NULL
missing.0.percent.gap <- NULL
for(seq.file in missing.0.species){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
gap.col <- NULL
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
gap.col <- union(gap.col, grep("-", seq))
}
# length
missing.0.length <- c(missing.0.length, length(seq))
# percent gap column
missing.0.percent.gap <- c(missing.0.percent.gap, length(gap.col)/length(seq))
}
missing.0.length
missing.0.percent.gap
# 20 files that have no missing genes
missing.0.summary <- NULL
missing.0.length <- NULL
missing.0.percent.gap <- NULL
for(seq.file in missing.0.species){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
gap.col <- NULL
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
gap.col <- union(gap.col, grep("-", seq))
}
missing.0.summary <- rbind(missing.0.summary, c(length(seq), length(seq) - length(gap.col), length(gap.col), length(gap.col)/length(seq)))
}
rownames(missing.0.summary) <- missing.0.species
colnames(missing.0.summary) <- c("length", "# col no gap", "# col with gap", "% gap col")
missing.0.summary
missing.1.species
length(missing.1.species)
missing.1.summary <- NULL
for(seq.file in missing.0.species){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
gap.col <- NULL
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
if(length(grep("-", seq)) < length(seq)){
gap.col <- union(gap.col, grep("-", seq))
}
}
missing.0.summary <- rbind(missing.0.summary, c(length(seq), length(seq) - length(gap.col), length(gap.col), length(gap.col)/length(seq)))
}
# 20 files that have no missing genes
missing.0.summary <- NULL
for(seq.file in missing.0.species){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
gap.col <- NULL
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
gap.col <- union(gap.col, grep("-", seq))
}
missing.0.summary <- rbind(missing.0.summary, c(length(seq), length(seq) - length(gap.col), length(gap.col), length(gap.col)/length(seq)))
}
rownames(missing.0.summary) <- missing.0.species
colnames(missing.0.summary) <- c("length", "# col no gap", "# col with gap", "% gap col")
missing.0.summary
# 46 files that have one species that contains missing genes
missing.1.summary <- NULL
for(seq.file in missing.0.species){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
gap.col <- NULL
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
if(length(grep("-", seq)) < length(seq)){
gap.col <- union(gap.col, grep("-", seq))
}
}
missing.1.summary <- rbind(missing.1.summary, c(length(seq), length(seq) - length(gap.col), length(gap.col), length(gap.col)/length(seq)))
}
rownames(missing.1.summary) <- missing.1.species
# 20 files that have no missing genes
missing.0.summary <- NULL
for(seq.file in missing.0.species){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
gap.col <- NULL
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
gap.col <- union(gap.col, grep("-", seq))
}
missing.0.summary <- rbind(missing.0.summary, c(length(seq), length(seq) - length(gap.col), length(gap.col), length(gap.col)/length(seq)))
}
rownames(missing.0.summary) <- missing.0.species
colnames(missing.0.summary) <- c("length", "# col no gap", "# col with gap", "% gap col")
missing.0.summary
# 46 files that have one species that contains missing genes
missing.1.summary <- NULL
for(seq.file in missing.1.species){
info <- read.table(paste("./intronAlignmentSeparated/", seq.file, sep = ""), as.is = TRUE)
gap.col <- NULL
for(row.num in 1:11){
seq <- strsplit(info[row.num, 2], "")[[1]]
if(length(grep("-", seq)) < length(seq)){
gap.col <- union(gap.col, grep("-", seq))
}
}
missing.1.summary <- rbind(missing.1.summary, c(length(seq), length(seq) - length(gap.col), length(gap.col), length(gap.col)/length(seq)))
}
rownames(missing.1.summary) <- missing.1.species
colnames(missing.1.summary) <- c("length", "# col no gap", "# col with gap", "% gap col")
missing.1.summary
