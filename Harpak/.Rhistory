seq = getSequence(id = Ensembl.id[1],
type = "ensembl_gene_id",
seqType = "gene_exon",
mart = mart)
show(seq)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.intron.seq
b = getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_intron", mart = mart)
b = getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "intron", mart = mart)
exon.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.seq
exon.seq$gene_exon
exon.intron.seq$gene_exon_intron
strsplit(exon.intron.seq$gene_exon_intron[1], exon.seq$gene_exon)
strsplit(exon.intron.seq$gene_exon_intron[1], exon.seq$gene_exon, fixed = TRUE)
exon.seq$gene_exon
strsplit(exon.intron.seq$gene_exon_intron[1], exon.seq$gene_exon[1], fixed = TRUE)
strsplit(exon.intron.seq$gene_exon_intron[1], exon.seq$gene_exon[2], fixed = TRUE)
strsplit(exon.intron.seq$gene_exon_intron[1], exon.seq$gene_exon[3], fixed = TRUE)
library(biomaRt)
Ensembl.id <- c("ENSG00000109272", "ENSG00000163737", "ENSG00000136943", "ENSG00000135047",
"ENSG00000158485","ENSG00000158477", "ENSG00000163564", "ENSG00000163563", "ENSG00000187626",
"ENSG0000018929")
mart <- useMart("ensembl", dataset="hsapiens_gene_ensembl")
library(biomaRt)
Ensembl.id <- c("ENSG00000109272", "ENSG00000163737", "ENSG00000136943", "ENSG00000135047",
"ENSG00000158485","ENSG00000158477", "ENSG00000163564", "ENSG00000163563", "ENSG00000187626",
"ENSG0000018929")
mart <- useMart("ensembl", dataset="hsapiens_gene_ensembl")
exon.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron
for(exon.num in 1:length(exon.seq$gene_exon)){
new.split <- strsplit(left.seq, exon.seq$gene_exon[exon.num])[[1]]
intron.list <- c(intron.list, new.split[1])
left.seq <- new.split[2]
}
intron.list
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon.num in 1:length(exon.seq$gene_exon)){
new.split <- strsplit(left.seq, exon.seq$gene_exon[exon.num])[[1]]
intron.list <- c(intron.list, new.split[1])
left.seq <- new.split[2]
}
intron.list
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
exon.num = 1
new.split <- strsplit(left.seq, exon.seq$gene_exon[exon.num])[[1]]
new.split
strsplit(left.seq, exon.seq$gene_exon[exon.num])
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon.num in 1:length(exon.seq$gene_exon)){
new.split <- strsplit(left.seq, exon.seq$gene_exon[exon.num])[[1]]
if(length(new.split) == 1){
left.seq <- new.split[1]
}else{
intron.list <- c(intron.list, new.split[1])
left.seq <- new.split[2]
}
}
intron.list
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon.num in 1:length(exon.seq$gene_exon)){
new.split <- strsplit(left.seq, exon.seq$gene_exon[exon.num])[[1]]
if(length(new.split) == 1){
left.seq <- new.split[1]
}else{
intron.list <- c(intron.list, new.split[1])
left.seq <- new.split[2]
}
print(intron.list)
}
exon.num = 1
new.split <- strsplit(left.seq, exon.seq$gene_exon[exon.num])[[1]]
if(length(new.split) == 1){
left.seq <- new.split[1]
}else{
intron.list <- c(intron.list, new.split[1])
left.seq <- new.split[2]
}
left.seq
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
new.split <- strsplit(left.seq, exon.seq$gene_exon[exon.num])[[1]]
new.split
if(length(new.split) == 1){
left.seq <- new.split[1]
}else{
intron.list <- c(intron.list, new.split[1])
left.seq <- new.split[2]
}
left.seq
new.split
exon.seq$gene_exon[exon.num]
exon.num
exon.seq$gene_exon
exon.intron.seq$gene_exon_intron
strsplit(exon.intron.seq$gene_exon_intron, exon.seq$gene_exon[2]
)
strsplit(exon.intron.seq$gene_exon_intron, exon.seq$gene_exon[3])
strsplit(exon.intron.seq$gene_exon_intron, exon.seq$gene_exon[1])
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon.num in 1:length(exon.seq$gene_exon)){
new.split <- strsplit(left.seq, exon.seq$gene_exon[exon.num])[[1]]
if(length(new.split) == 1){
left.seq <- new.split[1]
}else{
intron.list <- c(new.split[2], intron.list)
left.seq <- new.split[1]
}
print(intron.list)
}
intron.list
length(intron.list[2])
length(intron.list[2])
nchar(intron.list[2])
strsplit(intron.list[2], "GCCCAACCCTCCCCCTTCTAATGCCAT")
strsplit(intron.list[2], "GCCCATCCCTCCCCCTTCTAATGCCAT")
bb = strsplit(intron.list[2], "GCCCATCCCTCCCCCTTCTAATGCCAT")
nchar(bb[1])
nchar(bb[2])
bb
nchar(bb[[1[1])
nchar(bb[[1]][1])
nchar(bb[[1]][2])
group.id.list <- c()
mart <- useMart("ensembl", dataset="hsapiens_gene_ensembl")
mart <- useMart("ensembl", dataset="hsapiens_gene_ensembl")
for(Ensembl.id in Ensembl.id.list){
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon.num in 1:length(exon.seq$gene_exon)){
new.split <- strsplit(left.seq, exon.seq$gene_exon[exon.num])[[1]]
if(length(new.split) == 1){
left.seq <- new.split[1]
}else{
intron.list <- c(new.split[2], intron.list)
left.seq <- new.split[1]
}
}
print(Ensembl.id)
print(intron.list)
}
Ensembl.id.list <- c("ENSG00000109272", "ENSG00000163737", "ENSG00000136943", "ENSG00000135047",
"ENSG00000158485","ENSG00000158477", "ENSG00000163564", "ENSG00000163563", "ENSG00000187626",
"ENSG0000018929")
for(Ensembl.id in Ensembl.id.list){
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon.num in 1:length(exon.seq$gene_exon)){
new.split <- strsplit(left.seq, exon.seq$gene_exon[exon.num])[[1]]
if(length(new.split) == 1){
left.seq <- new.split[1]
}else{
intron.list <- c(new.split[2], intron.list)
left.seq <- new.split[1]
}
}
print(Ensembl.id)
print(intron.list)
}
ensembl.id
Ensembl.id
exon.seq$gene_exon
exon.intron.seq$gene_exon_intron
grep(exon.seq$gene_exon[1], exon.intron.seq$gene_exon_intron)
grep(exon.seq$gene_exon[1], exon.intron.seq$gene_exon_intron[1])
grep(exon.seq$gene_exon[2], exon.intron.seq$gene_exon_intron[1])
exon.seq$gene_exon[2]
exon.intron.seq$gene_exon_intron[1]
grep(exon.seq$gene_exon[2], exon.intron.seq$gene_exon_intron[1], fixed = TRUE)
grep(exon.seq$gene_exon[2], exon.intron.seq$gene_exon_intron[1], fixed = TRUE, value = TRUE)
gregexpr(exon.seq$gene_exon[2], exon.intron.seq$gene_exon_intron[1], fixed = TRUE, value = TRUE)
gregexpr(exon.seq$gene_exon[2], exon.intron.seq$gene_exon_intron[1])
gregexpr(exon.seq$gene_exon[2], exon.intron.seq$gene_exon_intron[1])[[1]]
gregexpr(exon.seq$gene_exon[2], exon.intron.seq$gene_exon_intron[1])[[1]][1]
gregexpr(exon.seq$gene_exon[2], exon.intron.seq$gene_exon_intron[1])[[1]][2]
gregexpr(exon.seq$gene_exon[2], exon.intron.seq$gene_exon_intron[1])[[1]][3]
gregexpr(exon.seq$gene_exon[2], exon.intron.seq$gene_exon_intron[1])[[1]][1]
exon.pos.list <- NULL
for(exon in exon.seq$gene_exon){
exon.pos.list <- c(exon.pos.list, gregexpr(exon, exon.intron.seq$gene_exon_intron[1])[[1]][1])
}
exon
gregexpr(exon, exon.intron.seq$gene_exon_intron[1])
exon %in% exon.intron.seq$gene_exon_intron[1]
exon.intron.seq$gene_exon_intron
exon
exon
"-" %in% exon
table(exon)
nchar(exon)
gregexpr(exon, exon.intron.seq$gene_exon_intron[1])
exon.pos.list <- c(exon.pos.list, gregexpr(exon, exon.intron.seq$gene_exon_intron[1], perl = TRUE)[[1]][1])
exon.pos.list <- NULL
for(exon in exon.seq$gene_exon){
exon.pos.list <- c(exon.pos.list, gregexpr(exon, exon.intron.seq$gene_exon_intron[1], perl = TRUE)[[1]][1])
}
exon.pos.list
length(exon.pos.list)
aa = 13:25
length(aa)
order(exon.pos.list)[aa]
order(exon.pos.list)
aa[order(exon.pos.list)]
aa=1:13
aa[order(exon.pos.list)]
library(biomaRt)
Ensembl.id.list <- c("ENSG00000109272", "ENSG00000163737", "ENSG00000136943", "ENSG00000135047",
"ENSG00000158485","ENSG00000158477", "ENSG00000163564", "ENSG00000163563", "ENSG00000187626",
"ENSG0000018929")
group.id.list <- c()
mart <- useMart("ensembl", dataset="hsapiens_gene_ensembl")
for(Ensembl.id in Ensembl.id.list){
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.pos.list <- NULL
for(exon in exon.seq$gene_exon){
exon.pos.list <- c(exon.pos.list, gregexpr(exon, exon.intron.seq$gene_exon_intron[1], perl = TRUE)[[1]][1])
}
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon in exon.seq$gene_exon[order(exon.pos.list)]){
new.split <- strsplit(left.seq, exon)[[1]]
if(length(new.split) == 1){
left.seq <- new.split[1]
}else{
intron.list <- c(intron.list, new.split[1])
left.seq <- new.split[2]
}
}
print(Ensembl.id)
print(intron.list)
}
Ensembl.id = Ensembl.id.list[1]
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.pos.list <- NULL
exon.pos.list <- NULL
for(exon in exon.seq$gene_exon){
exon.pos.list <- c(exon.pos.list, gregexpr(exon, exon.intron.seq$gene_exon_intron[1], perl = TRUE)[[1]][1])
}
exon.pos.list
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
exon = exon.seq$gene_exon[3]
new.split <- strsplit(left.seq, exon)[[1]]
new.split
library(biomaRt)
Ensembl.id.list <- c("ENSG00000109272", "ENSG00000163737", "ENSG00000136943", "ENSG00000135047",
"ENSG00000158485","ENSG00000158477", "ENSG00000163564", "ENSG00000163563", "ENSG00000187626",
"ENSG0000018929")
group.id.list <- c()
mart <- useMart("ensembl", dataset="hsapiens_gene_ensembl")
for(Ensembl.id in Ensembl.id.list){
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.pos.list <- NULL
for(exon in exon.seq$gene_exon){
exon.pos.list <- c(exon.pos.list, gregexpr(exon, exon.intron.seq$gene_exon_intron[1], perl = TRUE)[[1]][1])
}
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon in exon.seq$gene_exon[order(exon.pos.list)]){
new.split <- strsplit(left.seq, exon)[[1]]
if(length(new.split) == 1){
left.seq <- new.split[2]
}else{
intron.list <- c(intron.list, new.split[1])
left.seq <- new.split[2]
}
}
print(Ensembl.id)
print(intron.list)
}
new.split <- strsplit(left.seq, exon)[[1]]
Ensembl.id = Ensembl.id.list[1]
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.pos.list <- NULL
for(exon in exon.seq$gene_exon){
exon.pos.list <- c(exon.pos.list, gregexpr(exon, exon.intron.seq$gene_exon_intron[1], perl = TRUE)[[1]][1])
}
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
exon = exon.seq$gene_exon[3]
new.split <- strsplit(left.seq, exon)[[1]]
new.split
exon = exon.seq$gene_exon[2]
new.split <- strsplit(left.seq, exon)[[1]]
exon = exon.seq$gene_exon[3]
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
new.split <- strsplit(left.seq, exon)[[1]]
left.seq <- new.split[1]
exon = exon.seq$gene_exon[2]
new.split <- strsplit(left.seq, exon)[[1]]
new.split
exon.pos.list
exon.seq$gene_exon
exon.intron.seq
exon = exon.seq$gene_exon[1]
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
new.split <- strsplit(left.seq, exon)[[1]]
mew.spli
new.split
intron.list <- c(intron.list, new.split[1])
left.seq <- new.split[2]
exon = exon.seq$gene_exon[2]
new.split <- strsplit(left.seq, exon)[[1]]
new.split
intron.list <- c(intron.list, new.split[1])
left.seq <- new.split[2]
exon = exon.seq$gene_exon[3]
new.split <- strsplit(left.seq, exon)[[1]]
new.split
for(Ensembl.id in Ensembl.id.list){
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.pos.list <- NULL
for(exon in exon.seq$gene_exon){
exon.pos.list <- c(exon.pos.list, gregexpr(exon, exon.intron.seq$gene_exon_intron[1], perl = TRUE)[[1]][1])
}
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon in exon.seq$gene_exon[order(exon.pos.list)]){
new.split <- strsplit(left.seq, exon)[[1]]
if(length(new.split) == 1){
left.seq <- new.split[1]
intron.list <- c(intron.list, new.split[1])
}else{
if(nchar(new.split[1])){
intron.list <- c(intron.list, new.split[1])
}
left.seq <- new.split[2]
}
}
print(Ensembl.id)
print(intron.list)
}
exon
nchar(exon)
gregexpr(exon, exon.intron.seq$gene_exon_intron[1], perl = TRUE)
for(Ensembl.id in Ensembl.id.list){
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.pos.list <- NULL
for(exon in exon.seq$gene_exon){
exon.pos.list <- c(exon.pos.list, gregexpr(exon, exon.intron.seq$gene_exon_intron[1], perl = TRUE)[[1]][1])
}
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon in exon.seq$gene_exon[order(exon.pos.list)]){
new.split <- strsplit(left.seq, exon, perl = TRUE)[[1]]
if(length(new.split) == 1){
left.seq <- new.split[1]
intron.list <- c(intron.list, new.split[1])
}else{
if(nchar(new.split[1])){
intron.list <- c(intron.list, new.split[1])
}
left.seq <- new.split[2]
}
}
print(Ensembl.id)
print(intron.list)
}
order(exon.pos.list)
exon.pos.list
Ensembl.id
exon.seq
exon.intron.seq
for(Ensembl.id in Ensembl.id.list){
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.pos.list <- NULL
for(exon in exon.seq$gene_exon){
exon.pos.list <- c(exon.pos.list, gregexpr(exon, exon.intron.seq$gene_exon_intron[1], perl = TRUE)[[1]][1])
}
intron.length.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon in exon.seq$gene_exon[order(exon.pos.list)]){
new.split <- strsplit(left.seq, exon, perl = TRUE)[[1]]
if(length(new.split) == 1){
left.seq <- new.split[1]
intron.list <- c(intron.length.list, nchar(new.split[1]))
}else{
if(nchar(new.split[1])){
intron.list <- c(intron.length.list, nchar(new.split[1]))
}
left.seq <- new.split[2]
}
}
print(Ensembl.id)
print(intron.length.list)
print(sum(intron.length.list > 98))
}
new.split
nchar(new.split)
for(Ensembl.id in Ensembl.id.list){
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.pos.list <- NULL
for(exon in exon.seq$gene_exon){
exon.pos.list <- c(exon.pos.list, gregexpr(exon, exon.intron.seq$gene_exon_intron[1], perl = TRUE)[[1]][1])
}
intron.length.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon in exon.seq$gene_exon[order(exon.pos.list)]){
new.split <- strsplit(left.seq, exon, perl = TRUE)[[1]]
if(length(new.split) == 1){
left.seq <- new.split[1]
intron.length.list <- c(intron.length.list, nchar(new.split[1]))
}else{
if(nchar(new.split[1])){
intron.length.list <- c(intron.length.list, nchar(new.split[1]))
}
left.seq <- new.split[2]
}
}
print(Ensembl.id)
print(intron.length.list)
print(sum(intron.length.list > 98))
}
cat("Ensembl ID: ", Ensembl.id, "\n",
"Intron lengths: ", intron.length.list, "\n",
"# Intron length > 98: ", sum(intron.length.list > 98), "\n")
for(Ensembl.id in Ensembl.id.list){
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.pos.list <- NULL
for(exon in exon.seq$gene_exon){
exon.pos.list <- c(exon.pos.list, gregexpr(exon, exon.intron.seq$gene_exon_intron[1], perl = TRUE)[[1]][1])
}
intron.length.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon in exon.seq$gene_exon[order(exon.pos.list)]){
new.split <- strsplit(left.seq, exon, perl = TRUE)[[1]]
if(length(new.split) == 1){
left.seq <- new.split[1]
intron.length.list <- c(intron.length.list, nchar(new.split[1]))
}else{
if(nchar(new.split[1])){
intron.length.list <- c(intron.length.list, nchar(new.split[1]))
}
left.seq <- new.split[2]
}
}
cat("Ensembl ID: ", Ensembl.id, "\n",
"Intron lengths: ", intron.length.list, "\n",
"# Intron length > 98: ", sum(intron.length.list > 98), "\n")
}
Ensembl.id
Ensembl.id.list <- c("ENSG00000109272", "ENSG00000163737", "ENSG00000136943", "ENSG00000135047",
"ENSG00000158485","ENSG00000158477", "ENSG00000163564", "ENSG00000163563", "ENSG00000187626")
nchar("CGGGAAGCCCTGGGGCTGGGGAGGAATCCTCTAGGATCATGATCACAGCCACACTTAACGGAGAGCCTGCTGAGTGTCTGGCCACAGTGCCAGGCGCTGCACCTGCACCTCCCACCTGGTTAGAACAACTTCTGTCTGGGGGAGGTGTGATTTATGGTAAGGAAAAGAAGGCTGAAGGTAGTGGAAAAAGTCCCTAAAGTACCTCTGGCTACTCATGGAGT")
a="CGGGAAGCCCTGGGGCTGGGGAGGAATCCTCTAGGATCATGATCACAGCCACACTTAACGGAGAGCCTGCTGAGTGTCTGGCCACAGTGCCAGGCGCTGCACCTGCACCTCCCACCTGGTTAGAACAACTTCTGTCTGGGGGAGGTGTGATTTATGGTAAGGAAAAGAAGGCTGAAGGTAGTGGAAAAAGTCCCTAAAGTACCTCTGGCTACTCATGGAGT"
"N" %in% a
"C" %in% a
grepp("N", a)
grepl("N", a)
grepl("C", a)
grepl("-", a)
Ensembl.id = Ensembl.id.list[2]
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.seq <- getSequence(id = Ensembl.id, type = "ensembl_gene_id", seqType = "gene_exon", mart = mart)
exon.intron.seq <- getSequence(id = Ensembl.id[1], type = "ensembl_gene_id", seqType = "gene_exon_intron", mart = mart)
exon.pos.list <- NULL
for(exon in exon.seq$gene_exon){
exon.pos.list <- c(exon.pos.list, gregexpr(exon, exon.intron.seq$gene_exon_intron[1], perl = TRUE)[[1]][1])
}
intron.length.list <- NULL
intron.list <- NULL
left.seq <- exon.intron.seq$gene_exon_intron[1]
for(exon in exon.seq$gene_exon[order(exon.pos.list)]){
new.split <- strsplit(left.seq, exon, perl = TRUE)[[1]]
if(length(new.split) == 1){
left.seq <- new.split[1]
intron.length.list <- c(intron.length.list, nchar(new.split[1]))
intron.list <- c(intron.list, new.split[1])
}else{
if(nchar(new.split[1])){
intron.length.list <- c(intron.length.list, nchar(new.split[1]))
intron.list <- c(intron.list, new.split[1])
}
left.seq <- new.split[2]
}
}
intron.list
a
strsplit(intron.list[1], a)
nchar(a)
nchar(intron.list[1])
mart <- useMart("ensembl", dataset="hsapiens_gene_ensembl")
mart <- useMart("ensembl", dataset="hsapiens_gene_ensembl")
